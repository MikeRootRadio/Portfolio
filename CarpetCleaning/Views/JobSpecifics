CREATE VIEW [JobSpecifics] AS
    SELECT * FROM (
    SELECT j.JobId, j.JobDate, t.[Name], a.AddressNumber, a.Street, a.Apt, c.City, 
           a.State, a.Zipcode, j.Total,j.Discount, jd.Amount, st.ServiceName
    from DBO.Jobs j
    JOIN DBO.Technicians T ON t.TechnicianID = j.TechnicianID
    JOIN DBO.Addresses A ON A.AddressID = J.AddressID
    JOIN DBO.Cities C ON C.CityID = A.CityID
    JOIN DBO.JobDetails jd ON jd.JobID = J.JobID
    JOIN DBO.ServiceTypes st ON st.ServiceTypeID = jd.ServiceTypeID
    )T
    PIVOT(
        SUM(Amount)
        For ServiceName IN (
            Carpet,
            UrineTreatment,
            Protectant,
            Upholstery,
            AirDucts,
            Tile,
            DryerVent,
            Other)
    ) AS Pivot_Table;


